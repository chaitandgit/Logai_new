df["@timestamp"] = pd.to_datetime(df["@timestamp"], errors="coerce", utc=True)

# Drop rows with invalid timestamps if any
bad_ts = df["@timestamp"].isna().sum()
if bad_ts > 0:
    print(f"⚠️ Dropping {bad_ts} rows with invalid timestamps")
    df = df.dropna(subset=["@timestamp"])

df = df.sort_values("@timestamp")